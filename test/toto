

  Watcher
Bus receiving: [PM2] Spawning PM2 Bus receiving: server-watch:online
Testing 2016-06-11 22:46:13: [PM2][WORKER] Started with refreshing interval: 30000
[PM2] PM2 Successfully     2) should restart because of file edit
    3) should stop      2)     4) should      3) should get node.js ver    6) should delete process
    7) should watch json
id:0
2016-06-11 22:46:13: App name:echo id:0 online
2016-06-11 22:46:13: Starting execution sequence in -cluster mode- for app name:echo id:1
2016-06-11 22:46:13: App name:echo id:1 online
2016-06-11 22:46:13:       ✓ should fork one process (257ms)
2016-06-11 22:46:13:     Process State Machine
2016-06-11 22:46:13: Deleting process 0
2016-06-11 22:46:13: Stopping app:echo id:0
2016-06-11 22:46:13: App name:echo id:0 disconnected
2016-06-11 22:46:13: App [echo] with id [0] and pid [2880], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:14: Proc is not defined anymore or is being killed
2016-06-11 22:46:14: Deleting process 1
2016-06-11 22:46:14: Stopping app:echo id:1
2016-06-11 22:46:14: App name:echo id:1 disconnected
2016-06-11 22:46:14: App [echo] with id [1] and pid [2920], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:14: Starting execution sequence in -cluster mode- for app name:echo id:0
2016-06-11 22:46:14: App name:echo id:0 online
2016-06-11 22:46:14: Starting execution sequence in -cluster mode- for app name:echo id:1
2016-06-11 22:46:14: App name:echo id:1 online
2016-06-11 22:46:14:       ✓ should start a process (207ms)
2016-06-11 22:46:14: Stopping app:echo id:0
2016-06-11 22:46:14: Proc is not defined anymore or is being killed
2016-06-11 22:46:14: App name:echo id:0 disconnected
2016-06-11 22:46:14: App [echo] with id [0] and pid [2971], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:14:       ✓ should stop a process and ke      2) "after each" hook for "should process HAS post fixed logs with id (merge_logs: false)"
Sat, 11 Jun 2016 20:46:16 GMT pm2:cli Killing and deleting current deamon
Sat, 11 Jun 2016 20:46:16 GMT pm2:client Calling daemon method pm2:notifyKillPM2 on rpc socket:/tmp/282573679fa70ce9/rpc.sock
Sat, 11 Jun 2016 20:46:16 GMT pm2:client Calling daemon method pm2:getVersion on rpc socket:/tmp/282573679fa70ce9/rpc.sock
    3) "after all" hook


  0 passing (4s)
  3 failing

  1) Max memory restart programmatic Log merging should process HAS post fixed logs with id (merge_logs: false):
     Uncaught TypeError: Cannot read property 'pm2_env' of undefined
      at programmatic/logs.js:47:32
      at /home/shant/keymetrics/pm2/lib/CLI.js:575:21
      at /home/shant/keymetrics/pm2/lib/CLI.js:609:21
      at /home/shant/keymetrics/pm2/node_modules/async/lib/async.js:181:20
      at replenish (/home/shant/keymetrics/pm2/node_modules/async/lib/async.js:319:21)
      at /home/shant/keymetrics/pm2/node_modules/async/lib/async.js:330:15
      at Object.async.forEachLimit.async.eachLimit (/home/shant/keymetrics/pm2/node_modules/async/lib/async.js:220:35)
      at startApps (/home/shant/keymetrics/pm2/lib/CLI.js:591:11)
      at /home/shant/keymetrics/pm2/lib/CLI.js:573:14
      at /home/shant/keymetrics/pm2/node_modules/async/lib/async.js:52:16
      at replenish (/home/shant/keymetrics/pm2/node_modules/async/lib/async.js:314:29)
      at /home/shant/keymetrics/pm2/node_modules/async/lib/async.js:330:15
      at Object.async.forEachLimit.async.eachLimit (/home/shant/keymetrics/pm2/node_modules/async/lib/async.js:220:35)
      at /home/shant/keymetrics/pm2/lib/CLI.js:528:11
      at /home/shant/keymetrics/pm2/node_modules/pm2-axon-rpc/lib/client.js:45:10
      at Parser.<anonymous> (/home/shant/keymetrics/pm2/node_modules/pm2-axon/lib/sockets/req.js:67:8)
      at Parser._write (/home/shant/keymetrics/pm2/node_modules/pm2-axon/node_modules/amp/lib/stream.js:91:16)
      at doWrite (_stream_writable.js:300:12)
      at writeOrBuffer (_stream_writable.js:286:5)
      at Parser.Writable.write (_stream_writable.js:214:11)
      at Socket.ondata (_stream_readable.js:536:20)
      at readableAddChunk (_stream_readable.js:153:18)
      at Socket.Readable.push (_stream_readable.js:111:10)
      at Pipe.onread (net.js:531:20)

  2) Max memory restart programmatic "after each" hook for "should process HAS post fixed logs with id (merge_logs: false)":
     Error: timeout of 2000ms exceeded. Ensure the done() callback is being called in this test.
  

  3) Max memory restart programmatic "after all" hook:
     Error: timeout of 2000ms exceeded. Ensure the done() callback is being called in this test.
  



Sat, 11 Jun 2016 20:46:43 GMT pm2:worker [PM2][WORKER] My job here is done, next job in 30 seconds
Sat, 11 Jun 2016 20:47:13 GMT pm2:worker [PM2][WORKER] My job here is done, next job in 30 seconds
Sat, 11 Jun 2016 20:47:38 GMT pm2:ActionMethod [PM2] Did not override dump file because list of processes is empty
s)
2016-06-11 22:46:16: Deleting process 0
2016-06-11 22:46:16: Stopping app:child id:0
2016-06-11 22:46:16: App name:child id:0 disconnected
2016-06-11 22:46:16: App [child] with id [0] and pid [3131], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:16: Deleting process 1
2016-06-11 22:46:16: Stopping app:child id:1
2016-06-11 22:46:16: App name:child id:1 disconnecSat, 11 Jun 2016 20:46:29 GMT pm2:worker [PM2][WORKER] My job here is done, next job in 30 seconds
Sat, 11 Jun 2016 20:46:59 GMT pm2:worker [PM2][WORKER] My job here is done, next job in 30 seconds
Sat, 11 Jun 2016 20:47:29 GMT pm2:worker [PM2][WORKER] My job here is done, next job in 30 seconds
Sat, 11 Jun 2016 20:47:38 GMT pm2:ActionMethod [PM2] Did not override dump file because list of processes is empty
- for app name:child id:0
2016-06-11 22:46:16: App name:child id:0 online
2016-06-11 22:46:16: Starting execution sequence in -cluster mode- for app name:child id:1
2016-06-11 22:46:17: App name:child id:1 online
2016-06-11 22:46:17: Starting execution sequence in -cluster mode- for app name:child id:2
2016-06-11 22:46:17: App name:child id:2 online
2016-06-11 22:46:17: Starting execution sequence in -cluster mode- for app name:child id:3
2016-06-11 22:46:17: App name:child id:3 online
2016-06-11 22:46:17: Starting execution sequence in -cluster mode- for app name:child id:4
2016-06-11 22:46:17: App name:child id:4 online
2016-06-11 22:46:17: Starting execution sequence in -cluster mode- for app name:child id:5
2016-06-11 22:46:17: App name:child id:5 online
2016-06-11 22:46:17: Starting execution sequence in -cluster mode- for app name:child id:6
2016-06-11 22:46:17: App name:child id:6 online
2016-06-11 22:46:17: Starting execution sequence in -cluster mode- for app name:child id:7
2016-06-11 22:46:17: App name:child id:7 online
2016-06-11 22:46:17: Starting execution sequence in -cluster mode- for app name:child id:8
2016-06-11 22:46:17: App name:child id:8 online
2016-06-11 22:46:17: Starting execution sequence in -cluster mode- for app name:child id:9
2016-06-11 22:46:17: App name:child id:9 online
2016-06-11 22:46:17:       ✓ should start maximum processes depending on CPU numbers (677ms)
2016-06-11 22:46:17: Deleting process 0
2016-06-11 22:46:17: Stopping app:child id:0
2016-06-11 22:46:17: App name:child id:0 disconnected
2016-06-11 22:46:17: App [child] with id [0] and pid [3211], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:17: Deleting process 1
2016-06-11 22:46:17: Stopping app:child id:1
2016-06-11 22:46:17: App name:child id:1 disconnected
2016-06-11 22:46:17: App [child] with id [1] and pid [3216], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:17: Deleting process 2
2016-06-11 22:46:17: Stopping app:child id:2
2016-06-11 22:46:17: App name:child id:2 disconnected
2016-06-11 22:46:17: App [child] with id [2] and pid [3241], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:18: Deleting process 3
2016-06-11 22:46:18: Stopping app:child id:3
2016-06-11 22:46:18: App name:child id:3 disconnected
2016-06-11 22:46:18: App [child] with id [3] and pid [3258], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:18: Deleting process 4
2016-06-11 22:46:18: Stopping app:child id:4
2016-06-11 22:46:18: App name:child id:2016-06-11 22:46:28: Change detected on path donotwatchme.dir/test for app server-watch - restarting
2016-06-11 22:46:28: [Watch] PM2 is being killed, stopping restart procedure...
2016-06-11 22:46:28: Change detected on path watchme.sym/test for app server-watch - restarting
2016-06-11 22:46:28: [Watch] PM2 is being killed, stopping restart procedure...
2016-06-11 22:46:43: Change detected on path server-watch.js for app server-watch - restarting
2016-06-11 22:46:43: [Watch] PM2 is being killed, stopping restart procedure...
2016-06-11 22:46:43: [RestartProcessId] PM2 is being killed, stopping restart procedure...
2016-06-11 22:46:46: [RestartProcessId] PM2 is being killed, stopping restart procedure...
2016-06-11 22:46:46: Change detected on path server-watch.js for app server-watch - restarting
2016-06-11 22:46:46: [Watch] PM2 is being killed, stopping restart procedure...
2016-06-11 22:47:01: Change detected on path donotwatchme.dir/test for app server-watch - restarting
2016-06-11 22:47:01: [Watch] PM2 is being killed, stopping restart procedure...
2016-06-11 22:47:01: Change detected on path watchme.sym/test for app server-watch - restarting
2016-06-11 22:47:01: [Watch] PM2 is being killed, stopping restart procedure...
2016-06-11 22:47:03: Change detected on path donotwatchme.dir/test for app server-watch - restarting
2016-06-11 22:47:03: [Watch] PM2 is being killed, stopping restart procedure...
2016-06-11 22:47:03: Change detected on path watchme.sym/test for app server-watch - restarting
2016-06-11 22:47:03: [Watch] PM2 is being killed, stopping restart procedure...
2016-06-11 22:47:06: Change detected on path pm2.log for app server-watch - restarting
2016-06-11 22:47:06: [Watch] PM2 is being killed, stopping restart procedure...
2016-06-11 22:47:38: Deleting process 0
2016-06-11 22:47:38: Stopping app:server-watch id:0
2016-06-11 22:47:38: App [server-watch] with id [0] and pid [2875], exited with code [0] via signal [SIGINT]
2016-06-11 22:47:38: [HandleExit] PM2 is being killed, stopping restart procedure...
22:46:19: Deleting process 1
2016-06-11 22:46:19: Stopping app:child id:1
2016-06-11 22:46:19: App name:child id:1 disconnected
2016-06-11 22:46:19: App [child] with id [1] and pid [3469], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:19: Deleting process 2
2016-06-11 22:46:19: Stopping app:child id:2
2016-06-11 22:46:19: App name:child id:2 disconnected
2016-06-11 22:46:19: App [child] with id [2] and pid [3488], exited with code [0] via signal [SIGINT]
2016-06-11 22:46:19: Starting execution sequence in -fork mode- for app name:child id:0
2016-06-11 22:46:19: node [ '/home/shant/keymetrics/pm2/lib/ProcessContainerFork.js',
  '-d',
  '-a' ] /home/shant/keymetrics/pm2/test/programmatic /home/shant/keymetrics/pm2/test/programmatic /home/shant/keymetrics/pm2/test/programmatic
2016-06-11 22:46:19: App name:child id:0 online
2016-06-11 22:46:20:       ✓ should handle arguments (565ms)
2016-06-11 22:46:20: Deleting process 0
2016-06-11 22:46:20: Stopping app:child id:0
2016-06-11 22:46:20: App [child] with id [0] and pid [3539], exited with code [0] via signal [SIGINT]


2016-06-11 22:46:20:   12 passing (7s)

